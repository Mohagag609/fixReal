# 🗄️ دليل إعداد قاعدة البيانات

## ✅ تم إنشاء نظام إعداد قاعدة البيانات بنجاح!

### 🎯 المميزات الجديدة:

#### 1. **دعم متعدد لقواعد البيانات:**
- **SQLite** - للتطوير والاستخدام المحلي
- **PostgreSQL محلي** - للخوادم المحلية
- **PostgreSQL سحابي** - للخدمات السحابية (Neon, Supabase, إلخ)

#### 2. **واجهة إعداد جميلة ومتطورة:**
- تصميم حديث ومتجاوب
- رسائل خطأ واضحة ومفيدة
- اختبار الاتصال التلقائي
- حفظ الإعدادات محلياً

#### 3. **عملاء Prisma مولدين مسبقاً:**
- `prisma/generated/postgres` - عميل PostgreSQL
- `prisma/generated/sqlite` - عميل SQLite
- لا حاجة لإعادة البناء عند تغيير نوع قاعدة البيانات

### 🚀 كيفية الاستخدام:

#### 1. **تشغيل التطبيق:**
```bash
npm run dev
```

#### 2. **الوصول لصفحة الإعداد:**
- افتح المتصفح على `http://localhost:3000`
- إذا لم تكن قاعدة البيانات مُعدة، ستظهر رسالة توجيه لصفحة الإعداد
- أو اذهب مباشرة إلى `http://localhost:3000/setup`

#### 3. **اختيار نوع قاعدة البيانات:**

##### **SQLite (مستحسن للتطوير):**
- اختر "SQLite (ملف محلي)"
- اترك المسار الافتراضي `./data/dev.db` أو غيره
- اضغط "حفظ وتجربة الاتصال"

##### **PostgreSQL محلي:**
- تأكد من تثبيت PostgreSQL على جهازك
- اختر "PostgreSQL محلي"
- أدخل رابط الاتصال مثل: `postgresql://username:password@localhost:5432/database`
- اضغط "حفظ وتجربة الاتصال"

##### **PostgreSQL سحابي:**
- احصل على رابط من مزود الخدمة (Neon, Supabase, إلخ)
- اختر "PostgreSQL سحابي"
- أدخل رابط الاتصال السحابي
- اضغط "حفظ وتجربة الاتصال"

### 📁 الملفات الجديدة:

```
prisma/
├── postgres.prisma          # مخطط PostgreSQL
├── sqlite.prisma           # مخطط SQLite
└── generated/
    ├── postgres/           # عميل PostgreSQL المولد
    └── sqlite/             # عميل SQLite المولد

src/
├── app/setup/
│   └── page.tsx            # صفحة الإعداد الجميلة
├── app/api/setup/
│   └── route.ts            # API لحفظ واختبار الإعدادات
└── lib/
    ├── db/
    │   └── config.ts       # إدارة الإعدادات
    └── prisma-clients.ts   # اختيار العميل المناسب

var/
└── app-config.json         # ملف الإعدادات المحفوظ
```

### 🔧 السكريبتات الجديدة:

```bash
# توليد عملاء Prisma
npm run prisma:gen:pg       # عميل PostgreSQL فقط
npm run prisma:gen:sqlite   # عميل SQLite فقط
npm run prisma:gen          # كلا العميلين

# تشغيل التطبيق
npm run dev                 # وضع التطوير
npm run build              # بناء للإنتاج
npm run start              # تشغيل الإنتاج
```

### 🛠️ استكشاف الأخطاء:

#### **خطأ "ECONNREFUSED":**
- تأكد من تشغيل PostgreSQL على جهازك
- تحقق من رقم المنفذ (5432 عادة)

#### **خطأ "authentication failed":**
- تحقق من اسم المستخدم وكلمة المرور
- تأكد من صحة رابط الاتصال

#### **خطأ "database does not exist":**
- أنشئ قاعدة البيانات أولاً
- أو استخدم قاعدة بيانات موجودة

#### **خطأ "ENOENT" (SQLite):**
- تحقق من صحة مسار الملف
- تأكد من وجود المجلد

### 🎨 المميزات المتقدمة:

#### **1. اختبار الاتصال التلقائي:**
- يتم اختبار الاتصال قبل حفظ الإعدادات
- رسائل خطأ واضحة ومفيدة
- منع حفظ إعدادات خاطئة

#### **2. حفظ الإعدادات محلياً:**
- الإعدادات محفوظة في `var/app-config.json`
- لا حاجة لإعادة الإعداد في كل مرة
- إمكانية تغيير الإعدادات لاحقاً

#### **3. واجهة مستخدم متطورة:**
- تصميم حديث ومتجاوب
- دعم الوضع المظلم والفاتح
- رسائل نجاح وخطأ واضحة
- نصائح مفيدة للمستخدم

### 🔄 تغيير نوع قاعدة البيانات:

1. اذهب إلى `/setup`
2. اختر النوع الجديد
3. أدخل البيانات المطلوبة
4. اضغط "حفظ وتجربة الاتصال"
5. سيتم حفظ الإعدادات الجديدة تلقائياً

### 📝 ملاحظات مهمة:

- **SQLite** مثالي للتطوير والاختبار
- **PostgreSQL محلي** للخوادم المحلية
- **PostgreSQL سحابي** للإنتاج والاستخدام الجماعي
- يمكن تغيير نوع قاعدة البيانات في أي وقت
- الإعدادات محفوظة محلياً ولا تحتاج إعادة إعداد

### 🎉 النتيجة:

الآن لديك نظام إعداد قاعدة بيانات متطور وجميل يسمح لك بـ:
- اختيار نوع قاعدة البيانات المناسب
- اختبار الاتصال قبل الحفظ
- واجهة مستخدم حديثة وسهلة
- دعم كامل لجميع أنواع قواعد البيانات
- إمكانية تغيير الإعدادات بسهولة

**🏆 النظام جاهز للاستخدام!**



